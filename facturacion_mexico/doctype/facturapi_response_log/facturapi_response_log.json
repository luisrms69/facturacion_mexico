{
 "actions": [],
 "allow_rename": 0,
 "allow_guest_to_view": 0,
 "allow_copy": 0,
 "allow_import": 0,
 "allow_auto_repeat": 0,
 "autoname": "naming_series:",
 "creation": "2025-08-06 12:00:00.000000",
 "description": "Registro INMUTABLE de todas las interacciones con PAC/FacturAPI - Single Source of Truth para estados fiscales",
 "doctype": "DocType",
 "document_type": "Document",
 "engine": "InnoDB",
 "field_order": [
  "request_section",
  "request_id",
  "request_timestamp",
  "request_type",
  "request_payload",
  "column_break_request",
  "naming_series",
  "reference_doctype",
  "reference_name",
  "reference_company",
  "response_section",
  "response_timestamp",
  "response_payload",
  "response_http_code",
  "response_time_ms",
  "column_break_response",
  "timeout_flag",
  "retry_of",
  "retry_count",
  "system_error_section",
  "system_error",
  "created_by_system",
  "immutable_section",
  "is_immutable",
  "immutable_reason",
  "admin_override_flag"
 ],
 "fields": [
  {
   "fieldname": "request_section",
   "fieldtype": "Section Break",
   "label": "Información de Solicitud"
  },
  {
   "fieldname": "request_id",
   "fieldtype": "Data",
   "label": "ID Único de Solicitud",
   "reqd": 1,
   "unique": 1,
   "read_only": 1,
   "description": "UUID único generado para cada request - CRÍTICO para idempotencia"
  },
  {
   "fieldname": "request_timestamp",
   "fieldtype": "Datetime",
   "label": "Timestamp Solicitud",
   "reqd": 1,
   "read_only": 1,
   "description": "Momento exacto cuando se envió la solicitud al PAC"
  },
  {
   "fieldname": "request_type",
   "fieldtype": "Select",
   "label": "Tipo de Solicitud",
   "options": "timbrado\ncancelacion\nconsulta\nvalidacion\naddenda",
   "reqd": 1,
   "read_only": 1,
   "description": "Categoría de la operación realizada"
  },
  {
   "fieldname": "request_payload",
   "fieldtype": "JSON",
   "label": "Payload de Solicitud",
   "read_only": 1,
   "description": "Request completo enviado a FacturAPI (JSON)"
  },
  {
   "fieldname": "column_break_request",
   "fieldtype": "Column Break"
  },
  {
   "fieldname": "naming_series",
   "fieldtype": "Select",
   "label": "Serie de Nombres",
   "options": "PAC-LOG-.YYYY.-.MM.-.#####",
   "default": "PAC-LOG-.YYYY.-.MM.-.#####",
   "reqd": 1,
   "read_only": 1
  },
  {
   "fieldname": "reference_doctype",
   "fieldtype": "Data",
   "label": "DocType de Referencia",
   "read_only": 1,
   "description": "DocType que originó la solicitud (ej: Factura Fiscal Mexico)"
  },
  {
   "fieldname": "reference_name",
   "fieldtype": "Data",
   "label": "Nombre de Referencia",
   "read_only": 1,
   "description": "Nombre del documento que originó la solicitud"
  },
  {
   "fieldname": "reference_company",
   "fieldtype": "Link",
   "label": "Empresa",
   "options": "Company",
   "read_only": 1,
   "description": "Empresa asociada a la solicitud"
  },
  {
   "fieldname": "response_section",
   "fieldtype": "Section Break",
   "label": "Respuesta del PAC"
  },
  {
   "fieldname": "response_timestamp",
   "fieldtype": "Datetime",
   "label": "Timestamp Respuesta",
   "read_only": 1,
   "description": "Momento exacto cuando se recibió respuesta del PAC"
  },
  {
   "fieldname": "response_payload",
   "fieldtype": "JSON",
   "label": "Payload de Respuesta",
   "read_only": 1,
   "description": "Respuesta completa de FacturAPI (JSON)"
  },
  {
   "fieldname": "response_http_code",
   "fieldtype": "Int",
   "label": "Código HTTP",
   "read_only": 1,
   "description": "Código de respuesta HTTP (200, 400, 500, etc.)"
  },
  {
   "fieldname": "response_time_ms",
   "fieldtype": "Float",
   "label": "Tiempo de Respuesta (ms)",
   "read_only": 1,
   "description": "Tiempo transcurrido desde request hasta response"
  },
  {
   "fieldname": "column_break_response",
   "fieldtype": "Column Break"
  },
  {
   "fieldname": "timeout_flag",
   "fieldtype": "Check",
   "label": "Timeout Detectado",
   "read_only": 1,
   "default": 0,
   "description": "True si la solicitud dio timeout (>30s sin respuesta)"
  },
  {
   "fieldname": "retry_of",
   "fieldtype": "Link",
   "label": "Reintento de",
   "options": "FacturAPI Response Log",
   "read_only": 1,
   "description": "Referencia al log original si es un reintento"
  },
  {
   "fieldname": "retry_count",
   "fieldtype": "Int",
   "label": "Número de Reintento",
   "read_only": 1,
   "default": 0,
   "description": "Contador de reintentos (0 = intento original)"
  },
  {
   "fieldname": "system_error_section",
   "fieldtype": "Section Break",
   "label": "Errores del Sistema"
  },
  {
   "fieldname": "system_error",
   "fieldtype": "Text",
   "label": "Error Interno",
   "read_only": 1,
   "description": "Error interno del sistema si lo hubo (no del PAC)"
  },
  {
   "fieldname": "created_by_system",
   "fieldtype": "Link",
   "label": "Creado por Sistema",
   "options": "User",
   "read_only": 1,
   "description": "Usuario/sistema que originó la solicitud"
  },
  {
   "fieldname": "immutable_section",
   "fieldtype": "Section Break",
   "label": "Control de Inmutabilidad",
   "collapsible": 1,
   "collapsible_depends_on": "eval:doc.__islocal != 1"
  },
  {
   "fieldname": "is_immutable",
   "fieldtype": "Check",
   "label": "Registro Inmutable",
   "read_only": 1,
   "default": 1,
   "description": "Este registro NO puede ser modificado una vez creado"
  },
  {
   "fieldname": "immutable_reason",
   "fieldtype": "Data",
   "label": "Razón de Inmutabilidad",
   "read_only": 1,
   "default": "PAC Response - Single Source of Truth",
   "description": "Explicación de por qué este registro es inmutable"
  },
  {
   "fieldname": "admin_override_flag",
   "fieldtype": "Check",
   "label": "Override Administrativo",
   "read_only": 1,
   "default": 0,
   "description": "Solo Admin puede activar para casos excepcionales"
  }
 ],
 "has_web_view": 0,
 "hide_toolbar": 0,
 "idx": 0,
 "in_create": 0,
 "is_submittable": 0,
 "issingle": 0,
 "istable": 0,
 "max_attachments": 0,
 "modified": "2025-08-06 12:00:00.000000",
 "modified_by": "Administrator",
 "module": "Facturacion Mexico",
 "name": "FacturAPI Response Log",
 "name_case": "",
 "owner": "Administrator",
 "permissions": [
  {
   "create": 1,
   "delete": 0,
   "email": 1,
   "export": 1,
   "print": 1,
   "read": 1,
   "report": 1,
   "role": "System Manager",
   "share": 1,
   "write": 0
  },
  {
   "create": 0,
   "delete": 0,
   "email": 1,
   "export": 1,
   "print": 1,
   "read": 1,
   "report": 1,
   "role": "Fiscal Manager",
   "share": 0,
   "write": 0
  },
  {
   "create": 0,
   "delete": 0,
   "email": 0,
   "export": 0,
   "print": 1,
   "read": 1,
   "report": 1,
   "role": "Fiscal User",
   "share": 0,
   "write": 0
  }
 ],
 "quick_entry": 0,
 "read_only": 1,
 "read_only_onload": 1,
 "show_name_in_global_search": 0,
 "sort_field": "request_timestamp",
 "sort_order": "DESC",
 "title_field": "request_id",
 "track_changes": 1,
 "track_seen": 1,
 "track_views": 1
}